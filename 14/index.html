<!DOCTYPE html>
<html lang="en">
<head>
  <title>PHYSCI 70: Intro to Digital Fabrication </title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;600&display=swap" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link href="./style.css" rel="stylesheet">
</head>
<body>

  <script>
    var elmnt = document.getElementById("luther");
    function LutherStop() {
      elmnt.scrollIntoView();
    }
  </script>

  <div class="container-fluid" id="top">
    <div id="navbar">
    <a href="../index.html">Home</a>
    <a href="../01_intro/index.html">About</a>
    <a href="../14/index.html">Project</a>
    <a href="../14/index.html">This Week</a>
  </div>

  <div class="row" style="margin-top: 30px;">
    <div class="col-xl-12" style="margin-top: 30px; text-align: center;">
      <h3>Final Project: 3D Drawing</h3>
    </div>
  </div> 

  <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;">
    <div class="col-md-3">
    </div>
    <div class="col-md-6">
     <iframe width=100% height=394vh src="https://www.youtube.com/embed/xJ43RIc1dP4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
    <div class="col-md-3">
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%;">Motivations</h4>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> After a few weeks of class, I finally decided that I wanted to explore more applications of foil capacitance sensors. These plates measure capacitance. Essentially, the closer an object gets to the plate, the greater the current that a sensor reads. I also really like to draw, despite not being the best at it, making representing 3D objects on a piece of paper extremely difficult. So, I figured why not design a device to render my 3D mid-air sketches as a 2D picture? This way I could map coordinates to the changes in capacitance when I waved my hand over some plates, not to mention that it is a really fun way to actually produce what seems like sorcery with midair hand motions actually being represented on a computer screen. With this thought in mind, I could finally begin designing and building. </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> In reasearching for this project, I came upon a make tutorial for a 3D capacitance sensor linked below: </p>
      <div style="margin-top: -1vh; padding-left: 5%;">
        <a href="https://www.instructables.com/DIY-3D-Controller/" style="font-size: 1.9vw;">DIY 3D Controller Instructable</a>
      </div>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> Ultimately though, besides the physical cube structure, I had to abandon the tutorial and build the circuit and write my code based on what I had learned in lab and previous experience. Let's get started! </p>
    </div>
  </div>
    
   <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%;">What is Capacitance?</h4>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> In this project, capacitance, or the ability of a circuit to store energy, was crucial to allowing my hand to draw shapes in the air. The circuit that I built uses the capacitiveTouch library's capacitor design so that I could use the library in the code. Essentially, we send charge to a foil plate over a strong resistor via a send port on our microcontroller, while a resistor-less wire connected to a different arduino report recieves the signal. By timing how long it takes for the recieve wire to reach the built up charge of our sent signal, we can measure how close an object like my hand is to the foil plate. With this design, the closer that I put my hand to the foil, the longer that time would take as my hand absorbed more energy. You can check out the library and its description of the circuit for yourself in the link below. </p>
      <div style="margin-top: -1vh; padding-left: 5%;">
        <a href="https://playground.arduino.cc/Main/CapacitiveSensor/" style="font-size: 1.9vw;">Capacitive Touch Library</a>
      </div>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> Now that we have a better understanding of how capacitance works, we can proceed with our build. </p>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%;">Materials</h4>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 1 8 in. x 8 in. cardboard box </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 3 7.75 in. x 7.75 in. smooth aluminum foil sheets </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 1 roll of electrical tape </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 3 dual-ended alligator clip wires </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 1 breadboard </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 7 pieces of wire </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 3 10 Mega ohm resistors </p>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%; margin-top: -2vh;"> 1 Metro M0 Express and cable</p>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: -6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%;">The Build</h4>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;padding-left: 5%; padding-right: 5%;">
    <div class="col-sm-4">
      <img id="portrait" src="./cardboardFrame.jpg" class="img-responsive margin" style="width:100%; height: auto;" alt="Cardboard Frame">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 1. cut the cardboard box at its edges so that three faces of the box are still connected at a corner. This cardboard will be the frame for your capacitance sensors. </p>
    </div>
    <div class="col-sm-4">
      <img id="portrait" src="./foilTaped.jpg" class="img-responsive margin" style="width:100%; height: auto;" alt="Cardboard Frame">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 2. take your foil sheets and tape them centered on each interior cardboard wall. For now, only tape the outer edges to leave yourself room to add circuitry later on. </p>
    </div>
    <div class="col-sm-4">
      <img id="portrait" src="./clips.jpg" class="img-responsive margin" style="width:100%; height: auto;" alt="Cardboard Frame">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 3. attach your alligator clips to each sheet of foil and tape everything in place. When doing this, be sure that each foil does not touch another by taping the inner edges with electrical tape. </p>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: -6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%">The Electronics</h4>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;padding-left: 5%; padding-right: 5%;">
    <div class="col-sm-4">
      <img id="portrait" src="./firstCirc.jpg" class="img-responsive margin" style="width:100%; height: auto;" alt="first plug">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 4. Connect digital pin 5 of your Metro M0 to a row of your breadboard. This wire will send your output voltage to each sensor. For each of your three resistors, connect the gold-striped end to the row with your previous wire, and connect the other end to its own row of the breadboard. Be sure that the wires on your resistors don't touch each other!  </p>
    </div>
    <div class="col-sm-4">
      <img id="portrait" src="./secondCirc.jpg" class="img-responsive margin" style="width:100%; height: auto;" alt="Cardboard Frame">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 5. Place two wires into the breadboard at each new row that a resistor touches, for a total of six added wire pieces. Resistor 1 (R1) will have one wire connecting to digital pin 2 of your metro, resistor 2 (R2) will have one wire connecting to digiral pin 3, and resistor 3 (R3) will have one wire connecting to digital pin 4. </p>
    </div>
    <div class="col-sm-4">
      <img id="portrait" src="./fullCirc.jpg" class="img-responsive margin" style="width:100%; height: auto;" alt="Cardboard Frame">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 6. With the three remaining wires, R1's wire should connect to the plate that will be your y axis, R2's wire should connect to the plate that will be your x axis, and R3's wire should connect to the plate that will be your z axis. Use the corresponding alligator clips to attach. To avoid intereference, use electrical tape to wrap each clip and its wire together. </p>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: -6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%">The Code</h4>
    </div>
  </div>

  <div class="row" style="margin-top: 8vh; margin-bottom: 6vh;padding-left: 5%; padding-right: 5%;">
    <div class="col-md-6">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 7. Matching our pins from the building section, we can write a program in arduino to read each sensor's value as a 3D point in serial. I defined the Metro M0 pin numbers I used at the top so you can modify the values to match your setup.   </p>
      <pre style="background-color:transparent; color:#ddd"><code class="language-arduino hljs">
<span class="hljs-comment">#include &lt;CapacitiveSensor.h&gt;

//ports
 const int xPlate = 3;
 const int yPlate = 2;
 const int zPlate = 4;
 const int receive = 5;

//sensor definitions
CapacitiveSensor x = CapacitiveSensor(receive, xPlate);
CapacitiveSensor y = CapacitiveSensor(receive, yPlate);
CapacitiveSensor z = CapacitiveSensor(receive, zPlate);

void setup() {   
  Serial.begin(115200); 
}

void loop() {
  long sensorValueX = x.capacitiveSensor(1000);
  long sensorValueY = y.capacitiveSensor(1000);
  long sensorValueZ = z.capacitiveSensor(1000);
  String printer = "(" + String(sensorValueX)+ ", " +
                   String(sensorValueY)+ ", " +
                   String(sensorValueZ)+ ")";
  Serial.println(printer);
}



















</span>
</code></pre>
    </div>
    <div class="col-md-6">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> 8. Now, we can write a python script to read this serial data and convert it into a graph. One advantage of using python is that matplotlib will autoscale every axis, meaning we can simply use our raw coordinate information. </p>
      <pre style="background-color:transparent; color:#ddd"><code class="language-python">
<span class="comment">import serial
import numpy as np
import matplotlib.pyplot as plt

fig = plt.figure()
ax = plt.axes(projection='3d')

ser = serial.Serial('COM5') #replace 'COM5' with your own serial address
ser.flushInput()

#storage arrays
x = []
y = []
z = []

#clean serial data and add point information to respective storage arrays
try:
    while True:
        ser_bytes = ser.readline()
        decoded_bytes = ser_bytes[0:len(ser_bytes)-2].decode("utf-8")
        clean_point = decoded_bytes.replace(" ", "")
        cleaner_point = clean_point.strip("()")
        vals = cleaner_point.split(",")
        x.append(float(vals[0]))
        y.append(float(vals[1]))
        z.append(float(vals[2]))
        print(decoded_bytes)
        # break infinite data read with Ctrl+c keypress
except KeyboardInterrupt:
    print("Keyboard Interrupt")
    pass

# convert storage arrays into numpy arrays
r = np.array(x)
s = np.array(y)
t = np.array(z)

# label axes
ax.set_xlabel("x axis")
ax.set_ylabel("y axis")
ax.set_zlabel("z axis")

# plot points and connecting lines before showing us
ax.scatter3D(r, s, zs=t, c=t, cmap='Greens')
ax.plot3D(r, s, z)
plt.show() </span>
</code></pre>
    </div>
  </div>

  <div class="row" style="margin-top: -3vh; margin-bottom: -6vh;">
    <div class="col-xl-12">
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> Beware of some common python errors with the code. First, the program will read your data until you type Ctrl-C into the console that the program is operating in, so if you cannot make the program stop while running it, be sure that you have your program running in a terminal environment! Also, be sure to modify the serial port that you are reading from based on your computer (replacing "COM5"). </p>

      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> Finally, upload your arduino script to your metro M0 and run your python script with the board online. Your very own 3D drawing machine is ready!</p>
    </div>
  </div>

<div class="row" style="margin-top: 14vh; margin-bottom: 6vh;">
    <div class="col-xl-12">
      <h4 style="padding-left: 5%;">Final Thoughts</h4>
      <p style="font-size: 1.9vw; width: 95%; text-align: left; padding-left: 5%;"> Overall, I am pretty satisfied with my final product. I learned so much in designing both the code and the circuitry from scratch, and I definitely feel a lot more confident in my abilities because of it. I look forward to continuing to grow in the makerspace over the next three years! </p>
    </div>
  </div>

  <script>
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
      var currentScrollPos = window.pageYOffset;
      if (prevScrollpos > currentScrollPos) {
        document.getElementById("navbar").style.top = "0";
      } else {
        document.getElementById("navbar").style.top = "-100px";
      }
      prevScrollpos = currentScrollPos;
    }
  </script>
  
  
</div>

  <div class="row">
    <div class="col-xl-12" style="margin-bottom: 30px;">
      <p style="text-align: center; font-family: 'Titillium Web', sans-serif; color: white; "> © Lauren Cooke 2021 </p>
  </div>

</body>
</html>
